








<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Jupyter Notebook Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  
  <meta name="robots" content="noindex,nofollow">
  

  <!--NEW RELIC Start Perf Measurement-->
  
  <!--NREND-->

  <!-- Le styles -->
  <script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"692ac09ed6fd96933ee645e0beef7769",petok:"b9f44f3ec24583025327914af0af4c71e85c3230-1457578282-1800",zone:"jupyter.org",rocket:"0",apps:{"ga_key":{"ua":"UA-52617120-5","ga_bs":"2"}},sha2test:0}];!function(a,b){a=document.createElement("script"),b=document.getElementsByTagName("script")[0],a.async=!0,a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=fb690a32f5/cloudflare.min.js",b.parentNode.insertBefore(a,b)}()}}catch(e){};
//]]>
</script>
<link href="/static/build/styles.css" rel="stylesheet">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- Le fav and touch icons -->
  <link rel="shortcut icon" href="/static/ico/ipynb_icon_16x16.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144"
        href="/static/ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114"
        href="/static/ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72"
        href="/static/ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed"
        href="/static/ico/apple-touch-icon-57-precomposed.png">
  
  

  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Notebook on nbviewer">
  <meta name="twitter:description" content="Check out this Jupyter notebook!">

  
  <meta name="twitter:domain" content="nbviewer.ipython.org">
  <meta name="twitter:image:src" content="http://ipython.org/ipython-doc/dev/_images/ipynb_icon_128x128.png">

  
    <link href="/static/build/notebook.css" rel="stylesheet">
  

  

  
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript">
    </script>
    <script type="text/javascript">
      init_mathjax = function() {
        if (window.MathJax) {
          // MathJax loaded
          MathJax.Hub.Config({
            TeX: {
              equationNumbers: {
                autoNumber: "AMS",
                useLabelIds: true
              }
            },
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true,
              processEnvironments: true
            },
            displayAlign: 'center',
            "HTML-CSS": {
              styles: {'.MathJax_Display': {"margin": 0}},
              linebreaks: { automatic: true }
            }
          });
          MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
      }
      init_mathjax();
    </script>
  

<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-52617120-5']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>

<body>

  <!-- These are loaded at the top of the body so they are available to
       notebook cells when they are loaded below. -->
  <script src="/static/components/jquery/dist/jquery.min.js"></script>
  <script src="/static/components/requirejs/require.js"></script>
  <script src="/static/components/moment/min/moment.min.js"></script>

<!-- Navbar
================================================== -->
  <nav id="menubar" class="navbar navbar-default navbar-fixed-top" data-spy="affix">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <i class="fa fa-bars"></i>
        </button>
        <a class="navbar-brand" href="/">
          <img src="/static/img/nav_logo.svg" width="159"/>
        </a>
      </div>

      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a class="active" href="http://jupyter.org">JUPYTER</a>
          </li>
          <li>
    <a href="/faq" title="FAQ" >
      
        <span>FAQ</span>
      
    </a>
  </li>

          
  
    
      
        <li>
    <a href="/format/script/github/agcinsf/Analysis/blob/master/Catalog%20Analysis%20General%20Actual%20Use.ipynb" title="View as Code" >
      <span class="fa fa- fa-2x menu-icon"></span>
      <span class="menu-text">View as Code</span>
    </a>
  </li>
      
    
  
    
  

  

  
    <li>
    <a href="https://github.com/agcinsf/Analysis/blob/master/Catalog%20Analysis%20General%20Actual%20Use.ipynb" title="View on GitHub" >
      <span class="fa fa-github fa-2x menu-icon"></span>
      <span class="menu-text">View on GitHub</span>
    </a>
  </li>
  

  <li>
    <a href="https://raw.githubusercontent.com/agcinsf/Analysis/master/Catalog%20Analysis%20General%20Actual%20Use.ipynb" title="Download Notebook" download>
      <span class="fa fa-download fa-2x menu-icon"></span>
      <span class="menu-text">Download Notebook</span>
    </a>
  </li>

        </ul>
      </div><!-- /.navbar-collapse -->
      
      
    </div>
  </nav>

  <div class="container container-main">
    
  
  <ol class="breadcrumb">
    
      <li>
        <a href="/github/agcinsf/Analysis/tree/master">Analysis</a>
      </li>
    
      <li>
        <a href="/github/agcinsf/Analysis/tree/master/Catalog Analysis General Actual Use.ipynb">Catalog Analysis General Actual Use.ipynb</a>
      </li>
    
  </ol>
  
  <div id="notebook">
    <div id="notebook-container">
      
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><center><h1><FONT FACE="Vollkorn"><Font Color=navy> Analysis of Suppliers Catalogs</h1></p>
<p><center><h2> <OL Type = ' '>
Gaining visibility of supplier pricing and determining potential impact on the</p>
<p><Center>University of California, Berkeley and San Francisco</p>
<p><p></p>
<p><center><img src="http://calwatchdog.com/wp-content/uploads/2013/09/University_of_California_seal.png" ></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><Font FACE= Times><Font Size= 4> <b>Introduction<p> </b></p>
<p><p>
       The University of California, Berkeley and San Francisco have strategic relationships with core suppliers through which its students, faculty, and staff do routine business. The daily operations of UCSF and UC Berkeley are fueled by the constant procurement of goods and services off of an e-commerce system called BearBuy. It is through this system that suppliers are enabled to host product catalogs. The Procurement department is responsible for determining the impact of the suggested pricing. Through an analysis of the proposed catalogs, the University gains visibility into any future price increases or product removals and determines if the proposed catalog is acceptable to be purchased off of.
           <p></p>
<p><t>
<b> The Analysis:</b></p>
<p><p>  <t>    The several hosted catalogs all offer an abundant amount of products, ranging from a few thousand to over a million line items. In order to understand relevant product changes, the previous 12 months worth of campus spend through that supplier is matched up against both the current and proposed catalog. This narrows down the entirety of the catalog to the relevant products of which the campus purchases. From the past 12 month spend, the analysis determines whether or not there are price increases through the proposed catalog and if the supplier is following the terms of their contract.</p>
<p><p><p>Currently, the analysis does not take into account products of which the university has never purchased. The simple assumption that past historical spend accurately reflects forecasted purchases allows for an opportunity in an improvement in the analysis.</p>
<p><b>Benefits of Using Python/PANDAS:</b></p>
<p><p>
The routine review of proposed catalogs, the limits of Excel and time consumption of repeated manual analysis make an automated process that can  analyze and tackle the large amount data extremeley valuable. Python, and more specifically, PANDAS, is an excellent tool to run this continued analysis of determining potential price increases from the suppliers.</p>
<p><p>
    PANDAS allows for the easy manipulation of dataframes and the content within. The analyst inputs the correct file location of the catalogs to be analyzed as well as notes the specific campus and supplier. The code uses this data to ouptput all of the necessary content for determining if a price file is appropriate into a running log. This not only yields instant visibility into the impact of a catalog, but continuously organizes the results chronologically for easy recall.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">##Ac Version - 1/1/15</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">read_table</span><span class="p">,</span> <span class="n">read_csv</span><span class="p">,</span> <span class="n">merge</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#Variables</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;EPPENDOR_Organiza_V009_20141229171002496_001.txt&#39;</span><span class="p">,</span><span class="n">error_bad_lines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">proposed</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;EPPENDOR_Organiza_V010_20141229171011596_001.txt&#39;</span><span class="p">,</span><span class="n">error_bad_lines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">spend</span><span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;POData_Eppendorf.csv&#39;</span><span class="p">)</span>
<span class="n">campus</span> <span class="o">=</span> <span class="s1">&#39;UCSF&#39;</span>
<span class="n">supplier</span> <span class="o">=</span> <span class="s1">&#39;Eppendorf&#39;</span>

<span class="c1">#start fixing the data -- </span>
<span class="c1">#The wording suppliers choose is different for each one, so it is necessary to make the Units of Measure standard</span>
<span class="c1">#Change full words into abreviations to now actually pair up package with PK and box/BX, case with CS</span>
<span class="n">spend</span><span class="o">=</span><span class="n">spend</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Amount/UOM &amp; UOM&#39;</span><span class="p">:</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">,</span><span class="s1">&#39;SKU/Catalog #&#39;</span><span class="p">:</span><span class="s1">&#39;Part Number&#39;</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">clean_up</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*box.*&#39;</span><span class="p">,</span><span class="s1">&#39;BX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*package.*&#39;</span><span class="p">,</span><span class="s1">&#39;PK&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*case.*&#39;</span><span class="p">,</span><span class="s1">&#39;CS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*each.*&#39;</span><span class="p">,</span><span class="s1">&#39;EA&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>  
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
 
<span class="n">List</span><span class="o">=</span><span class="p">(</span><span class="n">spend</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">proposed</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">List</span><span class="p">:</span>
    <span class="n">clean_up</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    
<span class="c1">#Pivot out the spend data to get summary data and fewer rows</span>
<span class="n">spend_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">spend</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]))</span>
<span class="n">spend_summary</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[17]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Quantity</th>
    </tr>
    <tr>
      <th>PartUOM</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030 073363EA</th>
      <td> 5.000000</td>
    </tr>
    <tr>
      <th>0030 073428EA</th>
      <td> 5.000000</td>
    </tr>
    <tr>
      <th>0030014405BX</th>
      <td> 3.000000</td>
    </tr>
    <tr>
      <th>0030014413BX</th>
      <td> 4.750000</td>
    </tr>
    <tr>
      <th>0030014456BX</th>
      <td> 4.000000</td>
    </tr>
    <tr>
      <th>0030014480BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>0030014499BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>0030015215BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>0030015258BX</th>
      <td> 1.750000</td>
    </tr>
    <tr>
      <th>0030072260BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030072278BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030072286BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089421BX</th>
      <td> 9.333333</td>
    </tr>
    <tr>
      <th>0030089430BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089448BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089456BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>0030089464BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089561BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089570BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>0030089570EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089588EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089618BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089634BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089642BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089650BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030089669BX</th>
      <td> 1.714286</td>
    </tr>
    <tr>
      <th>0030089677BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>0030108310BX</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>0030119401BX</th>
      <td> 2.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>K03800451EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>K04800170EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>K06413000EA</th>
      <td> 6.000000</td>
    </tr>
    <tr>
      <th>K0641INN2EA</th>
      <td> 6.000000</td>
    </tr>
    <tr>
      <th>M07402542PK</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M07402590PK</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M11954001EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M12820014EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M12820500EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M12829904EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M13629901EA</th>
      <td> 3.000000</td>
    </tr>
    <tr>
      <th>M13629903EA</th>
      <td> 3.000000</td>
    </tr>
    <tr>
      <th>M13630112KT</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M13630114EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>M13630124EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>P02402670EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>P02402680EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>P06250640EA</th>
      <td> 5.000000</td>
    </tr>
    <tr>
      <th>P06285030EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>P06286140TY</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>PMBF4500EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>Q2PN0400035EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>Q2PN0400036EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>Q2PN0400037EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>Q2PN0400157EA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>k01600777EA</th>
      <td> 3.000000</td>
    </tr>
    <tr>
      <th>naEA</th>
      <td> 1.000000</td>
    </tr>
    <tr>
      <th>nanEA</th>
      <td> 2.111111</td>
    </tr>
    <tr>
      <th>nanan</th>
      <td> 1.017241</td>
    </tr>
    <tr>
      <th>p06285790EA</th>
      <td> 1.000000</td>
    </tr>
  </tbody>
</table>
<p>292 rows Ã— 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">##Import modules that have certain functions necessary to complete the analysis</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">df</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">merge</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">csv</span>

<span class="c1">#These are your variables that are unique to your file settings</span>

<span class="n">Current</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;EPPENDOR_Organiza_V009_20141229171002496_001.txt&#39;</span><span class="p">,</span><span class="n">error_bad_lines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Proposed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;EPPENDOR_Organiza_V010_20141229171011596_001.txt&#39;</span><span class="p">,</span><span class="n">error_bad_lines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Spend</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;POData_Eppendorf.csv&#39;</span><span class="p">)</span>

<span class="n">Campus</span><span class="o">=</span> <span class="s1">&#39;UCSF&#39;</span>
<span class="n">Supplier</span> <span class="o">=</span> <span class="s1">&#39;Eppendorf&#39;</span>




<span class="c1">#Suppliers specifiy Units of Measure differently:</span>
<span class="c1">#   Possible to see a variety of formats: 1/PK, Pack, PK, package </span>
<span class="c1">#Using the last two UOM won&#39;t work if you have package instead of 1/PK </span>

<span class="c1">#The wording suppliers choose is different for each one, so it is necessary to make the Units of Measure standard</span>
<span class="c1">#Change full words into abreviations to now actually pair up package with PK and box/BX, case with CS</span>

<span class="n">Spend</span><span class="o">=</span><span class="n">Spend</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Amount/UOM &amp; UOM&#39;</span><span class="p">:</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">,</span><span class="s1">&#39;SKU/Catalog #&#39;</span><span class="p">:</span><span class="s1">&#39;Part Number&#39;</span><span class="p">})</span>

<span class="c1">#In Amount/UOM &amp; UOM the unit of measure might be listed as 1/EA. This won&#39;t match up if in the Price catalog it is listed as EA</span>
<span class="c1">#Change each UOM column to only the LAST two characters to ensure similarities in format:</span>
<span class="c1"># Create a new Column called PartUOM so we can compare appropriately between all three files</span>

<span class="k">def</span> <span class="nf">clean_up</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*box.*&#39;</span><span class="p">,</span><span class="s1">&#39;BX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*package.*&#39;</span><span class="p">,</span><span class="s1">&#39;PK&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*case.*&#39;</span><span class="p">,</span><span class="s1">&#39;CS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*each.*&#39;</span><span class="p">,</span><span class="s1">&#39;EA&#39;</span><span class="p">)</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>  
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">List</span><span class="o">=</span><span class="p">(</span><span class="n">Spend</span><span class="p">,</span> <span class="n">Current</span><span class="p">,</span> <span class="n">Proposed</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">List</span><span class="p">:</span>
    <span class="n">clean_up</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
<span class="c1"># Merge the Proposed Catalog with the Current Catalog</span>
<span class="c1"># Create a new dataframe with the specific columns necessary for the analysis</span>

<span class="n">comparison</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">Current</span><span class="p">,</span> <span class="n">Proposed</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span> <span class="s1">&#39;_y&#39;</span><span class="p">))</span> 

<span class="n">comparison</span> <span class="o">=</span> <span class="n">comparison</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">,</span> <span class="s1">&#39;Price_x&#39;</span> <span class="p">,</span> <span class="s1">&#39;Price_y&#39;</span><span class="p">]]</span>

<span class="c1">#In order to properly analyze the data, we only want SKUs where they are not blank. Otherwise there is no way to tell if they should have been in a catalog</span>
<span class="c1">#This line of code omits all SKUS that are blank</span>

<span class="n">Spend</span> <span class="o">=</span> <span class="n">Spend</span><span class="p">[</span><span class="n">Spend</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Spend</span> <span class="o">=</span> <span class="n">Spend</span><span class="p">[</span><span class="n">Spend</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>

<span class="c1">#Want to get rid of SKUs where the person entered N/A. However, we don&#39;t use .str.contains because N/A COULD be a part of the SKU/Part #</span>
<span class="n">List</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;N.A.&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span><span class="s1">&#39;n/a&#39;</span><span class="p">,</span><span class="s1">&#39;n.a.&#39;</span><span class="p">,</span><span class="s1">&#39;na&#39;</span><span class="p">]</span>
<span class="n">Spend</span> <span class="o">=</span> <span class="n">Spend</span><span class="p">[</span><span class="o">-</span><span class="n">Spend</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Quote&#39;</span><span class="p">)]</span>
<span class="n">Spend</span> <span class="o">=</span> <span class="n">Spend</span><span class="p">[</span><span class="o">-</span><span class="n">Spend</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;quote&#39;</span><span class="p">)]</span>
<span class="n">Spend</span> <span class="o">=</span> <span class="n">Spend</span><span class="p">[</span><span class="o">-</span><span class="n">Spend</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;see attach&#39;</span><span class="p">)]</span>


<span class="c1">#Using .isin will filter out those SKUs where it exactly equals N/A isntead of just contains it. </span>
<span class="n">Spend</span> <span class="o">=</span> <span class="n">Spend</span><span class="p">[</span><span class="o">-</span><span class="n">Spend</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">List</span><span class="p">)]</span>


<span class="n">spend_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">spend</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">]))</span>

<span class="c1">#Merge the two catalog comparisons with the historic spend based on PartUOM</span>
<span class="c1">#Merging on &#39;Left&#39; means we want all values of the Spend and only the values of the comparison that match.</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">Spend</span><span class="p">,</span> <span class="n">comparison</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span> 

<span class="c1">#Extract only the columns that are relevant to the analysis</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span> <span class="s1">&#39;Part Number&#39;</span><span class="p">,</span><span class="s1">&#39;PartUOM&#39;</span><span class="p">,</span> <span class="s1">&#39;UNSPSC&#39;</span><span class="p">,</span><span class="s1">&#39;Manufacturer&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">,</span> <span class="s1">&#39;Unit Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Extended Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Price_x&#39;</span> <span class="p">,</span> <span class="s1">&#39;Price_y&#39;</span><span class="p">,</span><span class="s1">&#39;Item Type&#39;</span><span class="p">]]</span>

<span class="c1">#rename Price_x to Current Price and Price_y to Proposed Price for easier analysis</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Price_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Current Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Price_y&#39;</span><span class="p">:</span> <span class="s1">&#39;Proposed Price&#39;</span><span class="p">})</span>


<span class="c1">###########If you only want items that are SQ Hosted Product##########################################################################</span>
<span class="c1">##Hashtag this first</span>
<span class="c1">#analysis= analysis[analysis[&#39;Item Type&#39;] != &#39;NonCatalog Product&#39;]</span>


<span class="c1">##If there are any prices removed in the catalogs, the vendors will either put &#39;Price Removed&#39; in the Proposed catalog under Current or Proposed Prices</span>

<span class="c1">#For the rest of the analysis we don&#39;t want &#39;Price Removed&#39; since this is a string and we can&#39;t do operations on the entire column</span>
<span class="c1"># We do want to know how many items were removed</span>
<span class="c1">##  We can compute that now, and then later change the &#39;Price Removed&#39; to 0 so we can do calculations</span>
<span class="c1">#Here we sum the number of times Price Removed shows up in either of two columns to get the number of deleted items</span>

<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
<span class="n">removed</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Price Removed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">removed2</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Price Removed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1">#I put two variables because the vendor could have the Price removed in Current or Proposed Price</span>
<span class="nb">print</span> <span class="s2">&quot;The number of deleted items is </span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">removed</span><span class="p">,</span><span class="n">removed2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The number of deleted items is 0 and 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Some Price files may include $ and , in the prices so this will result in the number not being a float</span>
<span class="c1">#We use the if analysis...dtype to specify that if the Series is an Object, then we need to remove the $ and , and convert to float.</span>
<span class="c1">#Before I didn&#39;t specify this and the code omitted all data if I put .str.replace(&#39;$&#39;) when there was actually no $; Now the new code makes it applicable to any data</span>
<span class="c1"># Need to first omit the symbols </span>
<span class="c1">#Then convert to float through .astype</span>

<span class="k">if</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">):</span>
 <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="c1">#In the Current and/or Proposed Catalog, some prices may be labeled as Price Removed  </span>
<span class="c1">#Get rid of the Price Removed because these are strings and we want the entire column to consist of floats</span>
<span class="c1">#Replace the Price Removed with 0</span>

<span class="k">if</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">):</span>
 <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span> <span class="s1">&#39;Price Removed&#39;</span> <span class="p">,</span> <span class="n">value</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
 <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">):</span>
 <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span> <span class="s1">&#39;Price Removed&#39;</span> <span class="p">,</span> <span class="n">value</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
 <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>   

    
<span class="c1">#Append computed values at the end of the DataFrame that helps us in the final analysis </span>
<span class="c1">#Compute Ext. Current Price, Proposed Ext. Price, $ Difference and % Difference</span>

<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Ext. Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Ext. Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>


<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;$ Difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Ext. Price&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Ext. Price&#39;</span><span class="p">]</span>
<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;% Difference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;$ Difference&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Ext. Price&#39;</span><span class="p">]</span>


<span class="c1"># Let&#39;s add a validity column</span>
<span class="c1"># Validity answers the question, how much the comparable spend purchased is reflected in the current and proposed catalogs</span>
<span class="c1"># Recall, we already took out part numbers that were null or mislabeled by the user. </span>
<span class="c1"># We don&#39;t want this data since it won&#39;t accurately reflect an actual product.</span>
<span class="c1"># A SKU that is blank or mislabeled shouldn&#39;t be included in the analysis</span>

<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">*</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>


<span class="c1">## Now we can multiply the Extended prices by the Validity column to get the valid spend, valid current and proposed ext. prices</span>

<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid Spend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid&#39;</span><span class="p">]</span>
<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid Current Ext. Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Current Ext. Price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid&#39;</span><span class="p">]</span>
<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid Proposed Ext. Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Ext. Price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid&#39;</span><span class="p">]</span>


<span class="c1">#This locale allows us to convert floats into currency</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span> <span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span>


<span class="c1">##Sum up the column values to get a total price </span>
<span class="n">Spend</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">Valid_Spend</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid Spend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>



<span class="c1"># We can get the Validity percentage</span>
<span class="n">Validity_percentage</span> <span class="o">=</span> <span class="n">Valid_Spend</span> <span class="o">/</span> <span class="n">Spend</span>
<span class="n">valid_percentage</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{percent:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percent</span><span class="o">=</span> <span class="n">Validity_percentage</span><span class="p">)</span>

<span class="c1">#Sum up Current and Proposed Extended Prices</span>
<span class="n">Valid_CurrExt_Price</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid Current Ext. Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">Valid_ProposedExt_Price</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Valid Proposed Ext. Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">Total_Catalog_Price_Difference</span> <span class="o">=</span> <span class="n">Valid_ProposedExt_Price</span> <span class="o">-</span> <span class="n">Valid_CurrExt_Price</span>
<span class="n">Percent_Increase</span> <span class="o">=</span> <span class="n">Total_Catalog_Price_Difference</span><span class="o">/</span><span class="n">Valid_CurrExt_Price</span>


<span class="c1">#Understand the count of different SKU&#39;s purchased</span>
<span class="n">Count_SKUS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1">#Get an understanding for the total number of products purchased</span>
<span class="n">Sum_of_SKUS</span><span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>



<span class="c1">#set these variables equal to currency so the end result is easier to read</span>

<span class="n">spenddollars</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">currency</span><span class="p">(</span><span class="n">Spend</span><span class="p">)</span>
<span class="n">valid_spend_dollars</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">currency</span><span class="p">(</span><span class="n">Valid_Spend</span><span class="p">)</span>
<span class="n">current_price_dollars</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">currency</span> <span class="p">(</span><span class="n">Valid_CurrExt_Price</span><span class="p">)</span>
<span class="n">proposed_price_dollars</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">currency</span><span class="p">(</span><span class="n">Valid_ProposedExt_Price</span><span class="p">)</span>
<span class="n">price_difference_dollars</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">currency</span><span class="p">(</span><span class="n">Total_Catalog_Price_Difference</span><span class="p">)</span>

<span class="c1">#Now we want the percentage to actually look like a percentage</span>
<span class="c1">#Ex. .0007 will simply yield 0 if we don&#39;t format it properly</span>

<span class="n">percentage</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{percent:.2%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percent</span><span class="o">=</span><span class="n">Percent_Increase</span><span class="p">)</span>


<span class="c1">#Notice how the variables used are %s not %d. The locale.currency function changes the float into a string.</span>

<span class="nb">print</span> <span class="s2">&quot;The Total spend is </span><span class="si">%s</span><span class="s2"> and the valid spend is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">spenddollars</span><span class="p">,</span><span class="n">valid_spend_dollars</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Validity percentage is </span><span class="si">%s</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">valid_percentage</span>
<span class="nb">print</span> <span class="s2">&quot;The Total Quantity of SKUS analyzed is </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">Sum_of_SKUS</span>
<span class="nb">print</span> <span class="s2">&quot;The number of SKUS analyzed is </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">Count_SKUS</span>
<span class="nb">print</span> <span class="s2">&quot;The Total Valid Current Extended price is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">current_price_dollars</span>
<span class="nb">print</span> <span class="s2">&quot;The Total Valid Proposed Extended price is </span><span class="si">%s</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">proposed_price_dollars</span>
<span class="nb">print</span> <span class="s2">&quot;The dollar difference between Total Proposed and Total Current is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">price_difference_dollars</span>
<span class="nb">print</span> <span class="s2">&quot;The percent increase is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">percentage</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The Total spend is $280861.17 and the valid spend is $139889.44
Validity percentage is 49.81% 

The Total Quantity of SKUS analyzed is 1692
The number of SKUS analyzed is 275

The Total Valid Current Extended price is $144447.83
The Total Valid Proposed Extended price is $151650.14


The dollar difference between Total Proposed and Total Current is $7202.31
The percent increase is 4.99%
</pre>
</div>
</div>

<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/analyst/anaconda/lib/python2.7/site-packages/pandas/computation/expressions.py:184: UserWarning: evaluating in Python space because the &apos;*&apos; operator is not supported by numexpr for the bool dtype, use &apos;&amp;&apos; instead
  unsupported[op_str]))
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../Desktop/eppen.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Let&#39;s now get the spend for any products that were removed</span>
<span class="c1">#We can create a separate dataframe where the ProposedPrice is 0 AND there exists a Current Price</span>

<span class="c1">#First we need to fill the Proposed Prices to 0 if it is empty</span>
<span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#After filling in the empty spaces with 0 we create a dataframe where the Proposed Price is ONLY zero</span>
<span class="n">proposed_0</span><span class="o">=</span>  <span class="n">analysis</span><span class="p">[</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;Proposed Price&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1">#We don&#39;t want both Current and Proposed to be zero</span>
<span class="c1">#If there exists a current price and not a proposed then it shows that a price was removed</span>
<span class="c1">#Create a dataframe where Proposed Price is 0 and Current price is some number </span>

<span class="n">currentnot_zero</span> <span class="o">=</span> <span class="n">proposed_0</span><span class="p">[</span><span class="n">proposed_0</span><span class="p">[</span><span class="s1">&#39;Current Price&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#This variable will show the aggregated historic spend on the products that were removed</span>
<span class="n">Removed_Spend</span> <span class="o">=</span> <span class="n">currentnot_zero</span><span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1">#Let&#39;s put this value in currency notation</span>
<span class="n">Removed_Spend_Dollars</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">currency</span><span class="p">(</span><span class="n">Removed_Spend</span><span class="p">)</span>

<span class="nb">print</span> <span class="s2">&quot;The Removed Spend is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">Removed_Spend_Dollars</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The Removed Spend is $0.00
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/alexisperez/Documents/Catalogs for Analysis/Beckman/Analysis.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Create a pivot table to look at top UNSPSC&#39;s and specific numbers associated with those product categories</span>

<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">pivot_table</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
  
<span class="n">UNSPSC</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="p">(</span> <span class="n">analysis</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">,</span> <span class="s1">&#39;$ Difference&#39;</span><span class="p">,</span><span class="s1">&#39;Valid Current Ext. Price&#39;</span><span class="p">,</span><span class="s1">&#39;Valid Proposed Ext. Price&#39;</span><span class="p">],</span> <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;UNSPSC&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>

<span class="n">UNSPSC</span><span class="p">[</span><span class="s1">&#39;Percent Increase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNSPSC</span><span class="p">[</span><span class="s1">&#39;$ Difference&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">UNSPSC</span><span class="p">[</span><span class="s1">&#39;Valid Current Ext. Price&#39;</span><span class="p">]</span>
<span class="n">UNSPSC</span><span class="p">[</span><span class="s1">&#39;Percent Increase&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">UNSPSC</span><span class="p">[</span><span class="s1">&#39;Percent Increase&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>


<span class="c1">#Want to show the pivot table with the top UNSPSC&#39;s by spend</span>
<span class="c1">#Use .head() because some pivot tables will be too large to show all of the columns and we only care about the top 5 anyway</span>
<span class="n">UNSPSC</span><span class="o">=</span><span class="n">UNSPSC</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">:</span><span class="s1">&#39;Spend&#39;</span><span class="p">})</span>
<span class="n">UNSPSC</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Spend&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Create a pivot table to look at the summary of the proposed catalog impact by Manufacturer</span>

<span class="n">Manufacturer</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="p">(</span> <span class="n">analysis</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">,</span> <span class="s1">&#39;$ Difference&#39;</span><span class="p">,</span><span class="s1">&#39;Valid Current Ext. Price&#39;</span><span class="p">,</span><span class="s1">&#39;Valid Proposed Ext. Price&#39;</span><span class="p">],</span> <span class="n">rows</span> <span class="o">=</span> <span class="s1">&#39;Manufacturer&#39;</span><span class="p">,</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>


<span class="n">Manufacturer</span><span class="p">[</span><span class="s1">&#39;Percent Increase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Manufacturer</span><span class="p">[</span><span class="s1">&#39;$ Difference&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">Manufacturer</span><span class="p">[</span><span class="s1">&#39;Valid Current Ext. Price&#39;</span><span class="p">]</span>
<span class="n">Manufacturer</span><span class="p">[</span><span class="s1">&#39;Percent Increase&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">Manufacturer</span><span class="p">[</span><span class="s1">&#39;Percent Increase&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">Manufacturer</span><span class="o">=</span> <span class="n">Manufacturer</span><span class="p">[</span><span class="n">Manufacturer</span><span class="p">[</span><span class="s1">&#39;$ Difference&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>

<span class="n">Manufacturer</span><span class="o">=</span><span class="n">Manufacturer</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Extended Price&#39;</span><span class="p">:</span><span class="s1">&#39;Spend&#39;</span><span class="p">})</span>
<span class="n">Manufacturer</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Spend&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[38]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>$ Difference</th>
      <th>Spend</th>
      <th>Quantity</th>
      <th>Valid Current Ext. Price</th>
      <th>Valid Proposed Ext. Price</th>
      <th>Percent Increase</th>
    </tr>
    <tr>
      <th>Manufacturer</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Beckman Coulter</th>
      <td> 4590.120117</td>
      <td> 30333.271484</td>
      <td> 4</td>
      <td> 31450</td>
      <td> 36040.120117</td>
      <td> 14.594977</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>

<span class="n">date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2">/%Y&quot;</span><span class="p">)</span>

<span class="n">Summary</span><span class="o">=</span> <span class="n">df</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">Supplier</span><span class="o">=</span><span class="n">Supplier</span><span class="p">,</span><span class="n">Spend</span><span class="o">=</span><span class="n">spenddollars</span><span class="p">,</span><span class="n">Validity_Percent</span><span class="o">=</span><span class="n">valid_percentage</span><span class="p">,</span><span class="n">Price_Difference</span><span class="o">=</span><span class="n">price_difference_dollars</span><span class="p">,</span><span class="n">Percentage_of_Increase</span><span class="o">=</span><span class="n">percentage</span><span class="p">,</span><span class="n">Quantity_Removed</span><span class="o">=</span><span class="n">removed</span><span class="p">,</span><span class="n">Quantity_Removed2</span><span class="o">=</span><span class="n">removed2</span><span class="p">,</span><span class="n">Removed_Spend</span> <span class="o">=</span> <span class="n">Removed_Spend_Dollars</span><span class="p">,</span> <span class="n">Campus</span> <span class="o">=</span> <span class="n">Campus</span><span class="p">,</span> <span class="n">Date</span> <span class="o">=</span> <span class="n">date</span><span class="p">),])</span>

<span class="n">Log</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/alexisperez/Documents/Log of Price Files/Price File Log.csv&#39;</span><span class="p">)</span>
<span class="n">Log</span> <span class="o">=</span> <span class="n">Log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Summary</span><span class="p">)</span>
<span class="n">Log</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/alexisperez/Documents/Log of Price Files/Price File Log.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Update the Large CSV file of all catalogs </span>
<span class="c1">#Note we do have CAMPUS and SUPPLIER</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">read_table</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">fuzzy</span>
<span class="kn">from</span> <span class="nn">fuzzy</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">dmeta</span> <span class="o">=</span> <span class="n">fuzzy</span><span class="o">.</span><span class="n">DMetaphone</span><span class="p">()</span>

<span class="n">today</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="n">Campus</span><span class="o">=</span><span class="s1">&#39;UCSF&#39;</span>

<span class="n">catalog_dir</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/alexisperez/Documents/Catalog Data/New Files/&quot;</span>

<span class="n">catalog_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">catalog_dir</span><span class="p">,</span> <span class="n">Campus</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Titles.txt&quot;</span> <span class="o">%</span> <span class="n">Campus</span><span class="p">)</span>
<span class="n">catalog_titles</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span><span class="n">catalog_path</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_uniqueID</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DMeta Manf&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Manufacturer Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dmeta</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DMeta Manf Str&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DMeta Manf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;UOM Edited&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Packaging UOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*box.*&#39;</span><span class="p">,</span><span class="s1">&#39;BX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*package.*&#39;</span><span class="p">,</span><span class="s1">&#39;PK&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*case.*&#39;</span><span class="p">,</span><span class="s1">&#39;CS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.*each.*&#39;</span><span class="p">,</span><span class="s1">&#39;EA&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;UOM Edited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;UOM Edited&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> 
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Manufacturer Part Number Edited&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Manufacturer Part Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Unique ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;DMeta Manf Str&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Manufacturer Part Number Edited&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;UOM Edited&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>



<span class="k">for</span> <span class="n">supplier</span> <span class="ow">in</span> <span class="n">catalog_titles</span><span class="p">[</span><span class="s1">&#39;Titles&#39;</span><span class="p">]:</span>
        <span class="n">new_catalog</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span><span class="n">supplier</span><span class="p">)</span>
        <span class="n">new_catalog</span><span class="p">[</span><span class="s1">&#39;Supplier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">supplier</span>
        <span class="n">new_catalog</span><span class="p">[</span><span class="s1">&#39;Campus/UCOP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Campus</span>
        <span class="n">new_catalog</span><span class="p">[</span><span class="s1">&#39;Date Uploaded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">today</span>
        <span class="n">create_uniqueID</span><span class="p">(</span><span class="n">new_catalog</span><span class="p">)</span>

<span class="c1">#All_files=pd.read_csv(&#39;C:/Users/alexisperez/Catalog Data/All files with Unique ID&#39;)                 </span>
<span class="c1">#All_files.append(Proposed)</span>
                      
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">All_files</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/alexisperez/Documents/Catalog Data/All files with Unique ID.csv&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansired">---------------------------------------------------------------------------</span>
<span class="ansired">ValueError</span>                                Traceback (most recent call last)
<span class="ansigreen">&lt;ipython-input-2-eab665c5e17b&gt;</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      1</span> All_files<span class="ansiyellow">=</span>pd<span class="ansiyellow">.</span>read_csv<span class="ansiyellow">(</span><span class="ansiblue">&apos;C:/Users/alexisperez/Documents/Catalog Data/All files with Unique ID.csv&apos;</span><span class="ansiyellow">)</span><span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 2</span><span class="ansiyellow"> </span>Replace<span class="ansiyellow">=</span>All_files<span class="ansiyellow">[</span><span class="ansiyellow">-</span><span class="ansiyellow">(</span>All_files<span class="ansiyellow">[</span><span class="ansiblue">&apos;Supplier&apos;</span><span class="ansiyellow">]</span><span class="ansiyellow">.</span>str<span class="ansiyellow">.</span>contains<span class="ansiyellow">(</span><span class="ansiblue">&apos;HENRY&apos;</span><span class="ansiyellow">)</span> <span class="ansigreen">and</span> All_files<span class="ansiyellow">[</span><span class="ansiblue">&apos;Campus/UCOP&apos;</span><span class="ansiyellow">]</span> <span class="ansiyellow">==</span> Campus<span class="ansiyellow">)</span><span class="ansiyellow">]</span><span class="ansiyellow"></span>
<span class="ansigreen">      3</span> <span class="ansired">#Replace=Replace.append(new_catalog)</span><span class="ansiyellow"></span><span class="ansiyellow"></span>
<span class="ansigreen">      4</span> Replace<span class="ansiyellow"></span>

<span class="ansired">ValueError</span>: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Replace</span><span class="o">=</span> <span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">All_files</span><span class="p">[</span><span class="s1">&#39;Campus/UCOP&#39;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">Campus</span><span class="p">:</span>
     <span class="n">Replace</span><span class="o">=</span><span class="n">All_files</span><span class="p">[</span><span class="o">-</span><span class="n">All_files</span><span class="p">[</span><span class="s1">&#39;Supplier&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;HENRY&#39;</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="n">Replace</span> <span class="o">=</span> <span class="n">All_files</span>
        
<span class="n">Replace</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>

  </div>


  
    <footer class="footer hidden-print">
      <div class="container">
        <div class="col-md-4">
          <p>
            This website does not host notebooks, it only renders notebooks
            available on other websites.
          </p>
        </div>

        <div class="col-md-4">
          <p>
            Delivered by <a href="http://www.fastly.com/">Fastly</a>,
            Rendered by <a href="https://developer.rackspace.com/?nbviewer=awesome">Rackspace</a>
          </p>
          <p>
            nbviewer GitHub <a href="https://github.com/jupyter/nbviewer">repository</a>.
          </p>
        </div>

        <div class="col-md-4">
          
  
            
              <p>
                nbviewer version:
                <a href="https://github.com/jupyter/nbviewer/commit/41cd82f09350776a356420a4f7dedcaf52410650">
                  41cd82f
                </a>
              </p>
            
          
  
  <p>
    notebook version: <a href="https://github.com/jupyter/notebook/releases/tag/">
      
    </a>
  </p>
  <p>
    nbconvert version: <a href="https://github.com/jupyter/nbconvert/releases/tag/4.1.0">
      4.1.0
    </a>
  </p>
  

          
  
  
  <p>
    Rendered
    <span class='date' data-date='Thu, 10 Mar 2016 02:51:22 UTC' title='Thu, 10 Mar 2016 02:51:22 UTC'>(Thu, 10 Mar 2016 02:51:22 UTC)</span>
  </p>
  

        </div>
      </div>
    </footer>
  

  <script src="/static/components/bootstrap/js/bootstrap.min.js"></script>
  <script src="/static/components/headroom.js/dist/headroom.min.js"></script>
  <script src="/static/components/headroom.js/dist/jQuery.headroom.min.js"></script>

  
  
  <script>
    $(function(){ $("#menubar").headroom({
      tolerance: 5,
      offset: 205,
      classes: {
        initial: "animated",
        pinned: "slideInDown",
        unpinned: "slideOutUp"
      }
    })});
  </script>


  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-38683231-2', 'auto');
    ga('send', 'pageview');
  </script>
  <script>
    require({
        paths: {
          moment: "/static/components/moment/min/moment.min.js"
        }
      }, ["moment"], function(moment){
      var date = $("footer .date"),
        m = moment(new Date(date.data('date'))),
        update = function(){ date.text(m.fromNow()); };
      setInterval(update, 61*1000);
      update();
      var w = $(window).scroll(function(event){
        $("body").toggleClass("scrolled", w.scrollTop() > 0);
      });
    });
  </script>
  <!--NEW RELIC Stop Perf Measurement-->
  
  <!--NEW RELIC End-->
</body>
</html>